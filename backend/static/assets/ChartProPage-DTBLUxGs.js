import{j as s}from"./vendor-data-BGC679gK.js";import{r as a}from"./vendor-react-CfDhA8Yr.js";import{a as I,g as R}from"./v1Api-Dn2RRHac.js";import{L as $}from"./InteractiveChartContainer-5csOKzjJ.js";import"./vendor-charts-DCUSocby.js";import"./index-C61RkY3j.js";import"./vendor-radix-DB-zNCEb.js";import"./vendor-utils-CbPNna8o.js";function H(){const[l,h]=a.useState(""),[m,o]=a.useState([]),[i,C]=a.useState(null),[T,L]=a.useState(""),[c,E]=a.useState("daily"),[n,_]=a.useState(120),[r,b]=a.useState(null),[d,p]=a.useState(!1),[u,x]=a.useState(null);a.useEffect(()=>{if(l.trim().length===0){o([]);return}const e=setTimeout(async()=>{try{const t=await I(l,10);o(t)}catch{}},300);return()=>clearTimeout(e)},[l]);const j=a.useCallback(async e=>{p(!0),x(null);try{const t=await R(e,c,n);b(t)}catch(t){x(t.message)}finally{p(!1)}},[c,n]),P=e=>{C(e.ticker_id),L(e.name),h(`${e.ticker_id} ${e.name}`),o([]),j(e.ticker_id)};a.useEffect(()=>{i&&j(i)},[c,n]);const v=(r==null?void 0:r.candles.map((e,t)=>{var N,g,y,k,f,K,S,w;return{date:e.date,open:e.open??0,high:e.high??0,low:e.low??0,close:e.close??0,volume:e.volume??0,ma5:((g=(N=r.indicators)==null?void 0:N.ma5)==null?void 0:g[t])??void 0,ma10:((k=(y=r.indicators)==null?void 0:y.ma10)==null?void 0:k[t])??void 0,ma20:((K=(f=r.indicators)==null?void 0:f.ma20)==null?void 0:K[t])??void 0,ma60:((w=(S=r.indicators)==null?void 0:S.ma60)==null?void 0:w[t])??void 0}}))??[];return s.jsxs("div",{className:"chartpro-page",children:[s.jsxs("div",{className:"chartpro-header",children:[s.jsx("h1",{children:"ğŸ“ˆ å¢å¼· K ç·šåœ–"}),s.jsx("p",{className:"chartpro-subtitle",children:"v1 API è‚¡ç¥¨æœå°‹ + K ç·šå±•ç¤º"})]}),s.jsxs("div",{className:"chartpro-search",children:[s.jsxs("div",{className:"search-wrapper",children:[s.jsx("input",{className:"search-input",placeholder:"æœå°‹ä»£è™Ÿæˆ–åç¨± (å¦‚ 2330 æˆ– å°ç©é›»)",value:l,onChange:e=>h(e.target.value)}),m.length>0&&s.jsx("div",{className:"search-dropdown",children:m.map(e=>s.jsxs("div",{className:"search-item",onClick:()=>P(e),children:[s.jsx("span",{className:"search-ticker",children:e.ticker_id}),s.jsx("span",{className:"search-name",children:e.name}),s.jsx("span",{className:"search-industry",children:e.industry??""})]},e.ticker_id))})]}),s.jsxs("div",{className:"period-controls",children:[["daily","weekly","monthly"].map(e=>s.jsx("button",{className:`period-btn ${c===e?"active":""}`,onClick:()=>E(e),children:e==="daily"?"æ—¥K":e==="weekly"?"é€±K":"æœˆK"},e)),s.jsxs("select",{className:"limit-select",value:n,onChange:e=>_(parseInt(e.target.value)),children:[s.jsx("option",{value:60,children:"60å¤©"}),s.jsx("option",{value:120,children:"120å¤©"}),s.jsx("option",{value:250,children:"250å¤©"})]})]})]}),u&&s.jsx("div",{className:"chartpro-error",children:u}),s.jsxs("div",{className:"chartpro-chart",children:[d&&s.jsx("div",{className:"chartpro-loading",children:"è¼‰å…¥ä¸­â€¦"}),!d&&i&&v.length>0&&s.jsxs("div",{className:"chart-container",children:[s.jsxs("div",{className:"chart-title",children:[s.jsx("span",{className:"chart-ticker",children:i}),s.jsx("span",{className:"chart-name",children:T}),s.jsx("span",{className:"chart-period",children:c==="daily"?"æ—¥K":c==="weekly"?"é€±K":"æœˆK"})]}),s.jsx($,{data:v})]}),!d&&!i&&s.jsxs("div",{className:"chartpro-empty",children:[s.jsx("span",{className:"empty-icon",children:"ğŸ”"}),s.jsx("p",{children:"è«‹æœå°‹ä¸¦é¸æ“‡è‚¡ç¥¨"})]})]})]})}export{H as default};
