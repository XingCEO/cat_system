import{u as D,j as e}from"./vendor-data-BGC679gK.js";import{r,L as Z}from"./vendor-react-CfDhA8Yr.js";import{C as m,c,a as o,b as h}from"./card-DQvoVvYS.js";import{B as y}from"./index-C61RkY3j.js";import{I as p}from"./InteractiveChartContainer-5csOKzjJ.js";import{L as j}from"./label-BqY2c1Fb.js";import{f as H,a as U,g as G,b as J,S as V,c as W,o as X}from"./StockAnalysisDialog-NjrIpByB.js";import{C as Y,Z as q,p as L,d as k,T as ee,h as se}from"./vendor-utils-CbPNna8o.js";import"./vendor-radix-DB-zNCEb.js";import"./vendor-charts-DCUSocby.js";function oe(){const[t,g]=r.useState(""),[a,v]=r.useState(""),[n,M]=r.useState(""),[x,B]=r.useState(""),[d,b]=r.useState(null),[K,C]=r.useState(!1),[A,E]=r.useState(0),{data:i}=D({queryKey:["tradingDate"],queryFn:W});r.useEffect(()=>{i!=null&&i.latest_trading_day&&(t||g(i.latest_trading_day),a||v(i.latest_trading_day))},[i,t,a]);const P=()=>{E(s=>s+1)},{data:l,isLoading:T}=D({queryKey:["maBreakoutPage",t,a,n,x,A],queryFn:()=>X(t,a,n?parseFloat(n):void 0,x?parseFloat(x):void 0),enabled:!!t&&!!a}),u=(l==null?void 0:l.items)||[],I=(l==null?void 0:l.breakout_count)||0,z=(l==null?void 0:l.total_days)||0,f=t!==a,O=(s,N)=>{b({symbol:s,name:N}),C(!0)},Q=()=>{C(!1),b(null)},R=()=>t?t===a?t:`${t} ~ ${a}`:"-";return e.jsxs("div",{className:"container mx-auto py-6 px-4",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx(y,{variant:"ghost",size:"icon",asChild:!0,children:e.jsx(Z,{to:"/",children:e.jsx(Y,{className:"w-5 h-5"})})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(q,{className:"w-7 h-7 text-violet-400"}),"突破糾結均線篩選"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"5/10/20日均線在3%範圍內糾結，今日收盤突破（無周轉率限制）"})]})]}),e.jsx(m,{className:"mb-6",children:e.jsxs(c,{className:"pt-6",children:[e.jsxs("div",{className:"flex flex-wrap gap-4 items-end",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(j,{className:"flex items-center gap-1",children:[e.jsx(L,{className:"w-3 h-3"})," 開始日期"]}),e.jsx(p,{type:"date",value:t,onChange:s=>g(s.target.value),className:"w-44"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(j,{className:"flex items-center gap-1",children:[e.jsx(L,{className:"w-3 h-3"})," 結束日期"]}),e.jsx(p,{type:"date",value:a,onChange:s=>v(s.target.value),className:"w-44"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{children:"漲幅下限 (%)"}),e.jsx(p,{type:"number",step:"0.1",value:n,onChange:s=>M(s.target.value),className:"w-28",placeholder:"不限"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{children:"漲幅上限 (%)"}),e.jsx(p,{type:"number",step:"0.1",value:x,onChange:s=>B(s.target.value),className:"w-28",placeholder:"不限"})]}),e.jsxs(y,{onClick:P,className:"gap-1",children:[e.jsx(k,{className:"w-4 h-4"})," 查詢"]})]}),e.jsx("div",{className:"mt-4 pt-4 border-t",children:e.jsxs("div",{className:"flex items-start gap-2 text-sm text-muted-foreground",children:[e.jsx(ee,{className:"w-4 h-4 mt-0.5 text-violet-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground",children:"糾結均線突破條件："}),e.jsxs("ul",{className:"list-disc list-inside mt-1 space-y-0.5",children:[e.jsx("li",{children:"昨日 5/10/20 日均線範圍在 3% 以內（糾結）"}),e.jsx("li",{children:"今日收盤價突破所有均線"}),e.jsx("li",{children:"無周轉率排名限制，搜尋全市場"})]})]})]})})]})}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4 mb-6",children:[e.jsxs(m,{children:[e.jsx(o,{className:"pb-2",children:e.jsx(h,{className:"text-sm font-medium text-muted-foreground",children:"查詢日期"})}),e.jsxs(c,{children:[e.jsx("div",{className:"text-lg font-semibold",children:R()}),f&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:["共 ",z," 天"]})]})]}),e.jsxs(m,{className:"border-l-4 border-purple-500",children:[e.jsx(o,{className:"pb-2",children:e.jsx(h,{className:"text-sm font-medium text-violet-400",children:"突破糾結均線"})}),e.jsx(c,{children:e.jsxs("div",{className:"text-2xl font-bold text-violet-400",children:[I," 檔"]})})]}),e.jsxs(m,{children:[e.jsx(o,{className:"pb-2",children:e.jsx(h,{className:"text-sm font-medium text-muted-foreground",children:"搜尋範圍"})}),e.jsxs(c,{children:[e.jsx("div",{className:"text-lg font-semibold",children:"全市場"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"無周轉率限制"})]})]}),e.jsxs(m,{children:[e.jsx(o,{className:"pb-2",children:e.jsx(h,{className:"text-sm font-medium text-muted-foreground",children:"篩選條件"})}),e.jsx(c,{children:e.jsx("div",{className:"text-sm",children:n&&x?`漲幅 ${n}% ~ ${x}%`:n?`漲幅 ≥ ${n}%`:x?`漲幅 ≤ ${x}%`:"無漲幅限制"})})]})]}),e.jsxs(m,{children:[e.jsx(o,{className:"pb-2",children:e.jsxs(h,{className:"text-lg flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center gap-2 text-violet-400",children:[e.jsx(q,{className:"w-5 h-5"})," 突破糾結均線股票"]}),e.jsxs("span",{className:"text-sm font-normal text-muted-foreground",children:["共 ",u.length," 筆"]})]})}),e.jsx(c,{className:"p-0",children:T?e.jsx("div",{className:"py-20 text-center text-muted-foreground animate-pulse",children:"載入中..."}):u.length===0?e.jsx("div",{className:"py-20 text-center text-muted-foreground",children:"無符合條件的股票，請調整篩選條件後點擊「查詢」"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-muted/50 border-y",children:e.jsxs("tr",{children:[f&&e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium",children:"日期"}),e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium",children:"代號"}),e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium",children:"名稱"}),e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium",children:"產業"}),e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium",children:"收盤價"}),e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium",children:"漲幅"}),e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium",children:"周轉率"}),e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium",children:"成交量"}),e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium",children:"MA5"}),e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium",children:"MA10"}),e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium",children:"MA20"}),e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium",children:"均線範圍"}),e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium",children:"操作"})]})}),e.jsx("tbody",{className:"divide-y",children:u.map((s,N)=>{var w,_,S,F,$;return e.jsxs("tr",{className:"hover:bg-muted/30",children:[f&&e.jsx("td",{className:"px-3 py-3 text-xs text-muted-foreground",children:s.query_date||"-"}),e.jsx("td",{className:"px-3 py-3 font-mono",children:s.symbol}),e.jsxs("td",{className:"px-3 py-3",children:[s.name,e.jsx("span",{className:"ml-1",children:"⚡"})]}),e.jsx("td",{className:"px-3 py-3 text-muted-foreground text-xs",children:s.industry||"-"}),e.jsx("td",{className:"px-3 py-3 font-mono",children:H(s.close_price)}),e.jsx("td",{className:`px-3 py-3 font-mono font-semibold ${G(s.change_percent)}`,children:U(s.change_percent)}),e.jsxs("td",{className:"px-3 py-3 font-mono text-blue-500",children:[((w=s.turnover_rate)==null?void 0:w.toFixed(1))||"-","%"]}),e.jsx("td",{className:"px-3 py-3 font-mono",children:J(s.volume)}),e.jsx("td",{className:"px-3 py-3 font-mono text-xs",children:((_=s.ma5)==null?void 0:_.toFixed(2))||"-"}),e.jsx("td",{className:"px-3 py-3 font-mono text-xs",children:((S=s.ma10)==null?void 0:S.toFixed(2))||"-"}),e.jsx("td",{className:"px-3 py-3 font-mono text-xs",children:((F=s.ma20)==null?void 0:F.toFixed(2))||"-"}),e.jsx("td",{className:"px-3 py-3",children:e.jsxs("span",{className:"px-2 py-0.5 rounded text-xs bg-purple-500/10 text-violet-400",children:[(($=s.ma_range)==null?void 0:$.toFixed(1))||"-","%"]})}),e.jsx("td",{className:"px-3 py-3",children:e.jsx(y,{variant:"ghost",size:"sm",onClick:()=>O(s.symbol,s.name),className:"h-8 w-8 p-0",title:"查看K線圖",children:e.jsx(se,{className:"h-4 w-4"})})})]},`${s.symbol}-${s.query_date||N}`)})})]})})})]}),e.jsx(V,{open:K,onClose:Q,symbol:(d==null?void 0:d.symbol)||null,name:d==null?void 0:d.name})]})}export{oe as MaBreakoutPage};
