import{u as q,j as e}from"./vendor-data-BGC679gK.js";import{r as n,L as H}from"./vendor-react-CfDhA8Yr.js";import{C as i,c as m,a as o,b as h}from"./card-CimBm5Re.js";import{B as g}from"./index-CSe8uDaD.js";import{I as p,f as U,a as G,g as J,b as V}from"./InteractiveChartContainer-bW4zGEkZ.js";import{L as j}from"./label-FLPqfpVm.js";import{S as W,g as X,k as Y}from"./StockAnalysisDialog-aFjsypvL.js";import{i as k,Z as M,q as L,f as ee,T as se,h as te}from"./vendor-utils-Duyaqd-6.js";import"./vendor-radix-DB-zNCEb.js";import"./vendor-charts-D18Uve9I.js";function he(){const[t,v]=n.useState(""),[a,b]=n.useState(""),[x,B]=n.useState(""),[r,K]=n.useState(""),[d,C]=n.useState(null),[T,w]=n.useState(!1),u=n.useRef(""),[A,E]=n.useState(0),{data:c}=q({queryKey:["tradingDate"],queryFn:X,staleTime:5*6e4,refetchOnMount:"always"});n.useEffect(()=>{if(c!=null&&c.latest_trading_day){const s=c.latest_trading_day;(!t||t===u.current)&&v(s),(!a||a===u.current)&&b(s),u.current=s}},[c]);const P=()=>{E(s=>s+1)},{data:l,isLoading:R}=q({queryKey:["maBreakoutPage",t,a,x,r,A],queryFn:()=>Y(t,a,x?parseFloat(x):void 0,r?parseFloat(r):void 0),enabled:!!t&&!!a}),f=(l==null?void 0:l.items)||[],I=(l==null?void 0:l.breakout_count)||0,O=(l==null?void 0:l.total_days)||0,N=t!==a,z=(s,y)=>{C({symbol:s,name:y}),w(!0)},Q=()=>{w(!1),C(null)},Z=()=>t?t===a?t:`${t} ~ ${a}`:"-";return e.jsxs("div",{className:"container mx-auto py-6 px-4",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx(g,{variant:"ghost",size:"icon",asChild:!0,children:e.jsx(H,{to:"/",children:e.jsx(k,{className:"w-5 h-5"})})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(M,{className:"w-7 h-7 text-violet-400"}),"突破糾結均線篩選"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"5/10/20日均線在3%範圍內糾結，今日收盤突破（無周轉率限制）"})]})]}),e.jsx(i,{className:"mb-6",children:e.jsxs(m,{className:"pt-6",children:[e.jsxs("div",{className:"flex flex-wrap gap-4 items-end",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(j,{className:"flex items-center gap-1",children:[e.jsx(L,{className:"w-3 h-3"})," 開始日期"]}),e.jsx(p,{type:"date",value:t,onChange:s=>v(s.target.value),className:"w-44"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(j,{className:"flex items-center gap-1",children:[e.jsx(L,{className:"w-3 h-3"})," 結束日期"]}),e.jsx(p,{type:"date",value:a,onChange:s=>b(s.target.value),className:"w-44"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{children:"漲幅下限 (%)"}),e.jsx(p,{type:"number",step:"0.1",value:x,onChange:s=>B(s.target.value),className:"w-28",placeholder:"不限"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{children:"漲幅上限 (%)"}),e.jsx(p,{type:"number",step:"0.1",value:r,onChange:s=>K(s.target.value),className:"w-28",placeholder:"不限"})]}),e.jsxs(g,{onClick:P,className:"gap-1",children:[e.jsx(ee,{className:"w-4 h-4"})," 查詢"]})]}),e.jsx("div",{className:"mt-4 pt-4 border-t",children:e.jsxs("div",{className:"flex items-start gap-2 text-sm text-muted-foreground",children:[e.jsx(se,{className:"w-4 h-4 mt-0.5 text-violet-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground",children:"糾結均線突破條件："}),e.jsxs("ul",{className:"list-disc list-inside mt-1 space-y-0.5",children:[e.jsx("li",{children:"昨日 5/10/20 日均線範圍在 3% 以內（糾結）"}),e.jsx("li",{children:"今日收盤價突破所有均線"}),e.jsx("li",{children:"無周轉率排名限制，搜尋全市場"})]})]})]})})]})}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4 mb-6",children:[e.jsxs(i,{children:[e.jsx(o,{className:"pb-2",children:e.jsx(h,{className:"text-sm font-medium text-muted-foreground",children:"查詢日期"})}),e.jsxs(m,{children:[e.jsx("div",{className:"text-lg font-semibold",children:Z()}),N&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:["共 ",O," 天"]})]})]}),e.jsxs(i,{className:"border-l-4 border-purple-500",children:[e.jsx(o,{className:"pb-2",children:e.jsx(h,{className:"text-sm font-medium text-violet-400",children:"突破糾結均線"})}),e.jsx(m,{children:e.jsxs("div",{className:"text-2xl font-bold text-violet-400",children:[I," 檔"]})})]}),e.jsxs(i,{children:[e.jsx(o,{className:"pb-2",children:e.jsx(h,{className:"text-sm font-medium text-muted-foreground",children:"搜尋範圍"})}),e.jsxs(m,{children:[e.jsx("div",{className:"text-lg font-semibold",children:"全市場"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"無周轉率限制"})]})]}),e.jsxs(i,{children:[e.jsx(o,{className:"pb-2",children:e.jsx(h,{className:"text-sm font-medium text-muted-foreground",children:"篩選條件"})}),e.jsx(m,{children:e.jsx("div",{className:"text-sm",children:x&&r?`漲幅 ${x}% ~ ${r}%`:x?`漲幅 ≥ ${x}%`:r?`漲幅 ≤ ${r}%`:"無漲幅限制"})})]})]}),e.jsxs(i,{children:[e.jsx(o,{className:"pb-2",children:e.jsxs(h,{className:"text-lg flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center gap-2 text-violet-400",children:[e.jsx(M,{className:"w-5 h-5"})," 突破糾結均線股票"]}),e.jsxs("span",{className:"text-sm font-normal text-muted-foreground",children:["共 ",f.length," 筆"]})]})}),e.jsx(m,{className:"p-0",children:R?e.jsx("div",{className:"py-20 text-center text-muted-foreground animate-pulse",children:"載入中..."}):f.length===0?e.jsx("div",{className:"py-20 text-center text-muted-foreground",children:"無符合條件的股票，請調整篩選條件後點擊「查詢」"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-muted/50 border-y",children:e.jsxs("tr",{children:[N&&e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium",children:"日期"}),e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium",children:"代號"}),e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium",children:"名稱"}),e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium",children:"產業"}),e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium",children:"收盤價"}),e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium",children:"漲幅"}),e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium",children:"周轉率"}),e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium",children:"成交量"}),e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium",children:"MA5"}),e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium",children:"MA10"}),e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium",children:"MA20"}),e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium",children:"均線範圍"}),e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium",children:"操作"})]})}),e.jsx("tbody",{className:"divide-y",children:f.map((s,y)=>{var _,S,D,F,$;return e.jsxs("tr",{className:"hover:bg-muted/30",children:[N&&e.jsx("td",{className:"px-3 py-3 text-xs text-muted-foreground",children:s.query_date||"-"}),e.jsx("td",{className:"px-3 py-3 font-mono",children:s.symbol}),e.jsxs("td",{className:"px-3 py-3",children:[s.name,e.jsx("span",{className:"ml-1",children:"⚡"})]}),e.jsx("td",{className:"px-3 py-3 text-muted-foreground text-xs",children:s.industry||"-"}),e.jsx("td",{className:"px-3 py-3 font-mono",children:U(s.close_price)}),e.jsx("td",{className:`px-3 py-3 font-mono font-semibold ${J(s.change_percent)}`,children:G(s.change_percent)}),e.jsxs("td",{className:"px-3 py-3 font-mono text-blue-500",children:[((_=s.turnover_rate)==null?void 0:_.toFixed(1))||"-","%"]}),e.jsx("td",{className:"px-3 py-3 font-mono",children:V(s.volume)}),e.jsx("td",{className:"px-3 py-3 font-mono text-xs",children:((S=s.ma5)==null?void 0:S.toFixed(2))||"-"}),e.jsx("td",{className:"px-3 py-3 font-mono text-xs",children:((D=s.ma10)==null?void 0:D.toFixed(2))||"-"}),e.jsx("td",{className:"px-3 py-3 font-mono text-xs",children:((F=s.ma20)==null?void 0:F.toFixed(2))||"-"}),e.jsx("td",{className:"px-3 py-3",children:e.jsxs("span",{className:"px-2 py-0.5 rounded text-xs bg-purple-500/10 text-violet-400",children:[(($=s.ma_range)==null?void 0:$.toFixed(1))||"-","%"]})}),e.jsx("td",{className:"px-3 py-3",children:e.jsx(g,{variant:"ghost",size:"sm",onClick:()=>z(s.symbol,s.name),className:"h-8 w-8 p-0",title:"查看K線圖",children:e.jsx(te,{className:"h-4 w-4"})})})]},`${s.symbol}-${s.query_date||y}`)})})]})})})]}),e.jsx(W,{open:T,onClose:Q,symbol:(d==null?void 0:d.symbol)||null,name:d==null?void 0:d.name})]})}export{he as MaBreakoutPage};
